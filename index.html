<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Fire Emote Claim Center - Mockup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Set log level for debugging
        setLogLevel('debug');

        // Global Firebase variables
        let db;
        let auth;
        let userId = 'unknown';

        /* * ====================================================================
        * 1. CHANGE YOUR IMAGE URLS HERE
        * Replace the placeholder URLs with the direct links to your hosted images.
        * ====================================================================
        */
        const emotes = {
            // NOTE: The URLs below are placeholders. Replace them with your actual image links!
            'lol-emote-1': { 
                name: 'LOL Emote (Victory Dance)', 
                url: 'https://ibb.co/sJR6t9Zy

            }, 
            'lol-emote-2': { 
                name: 'LOL Emote (Waving)', 
                url: 'https://placehold.co/250x250/1E90FF/ffffff?text=WAVING'        // <-- REPLACE THIS URL with your image link
            }, 
            'lol-emote-3': { 
                name: 'LOL Emote (Heart)', 
                url: 'https://placehold.co/250x250/FF69B4/ffffff?text=HEART'         // <-- REPLACE THIS URL with your image link
            }, 
            'lol-emote-4': { 
                name: 'LOL Emote (Flex)', 
                url: 'https://placehold.co/250x250/32CD32/ffffff?text=FLEX'          // <-- REPLACE THIS URL with your image link
            }, 
            'lol-emote-5': { 
                name: 'LOL Emote (Running Man)', 
                url: 'https://placehold.co/250x250/FFA07A/ffffff?text=RUNNING%20MAN' 
            },
            'lol-emote-6': { 
                name: 'LOL Emote (Image Option)', 
                url: 'https://placehold.co/250x250/800080/ffffff?text=IMAGE%20OPTION' 
            },
            // --- NEW EMOTE ADDED (Seventh Option) ---
            'lol-emote-7': { 
                name: 'LOL Emote (Seventh Option)', 
                // PASTE YOUR DIRECT IMAGE LINK (must start with http:// or https://) BELOW
                url: 'https://placehold.co/250x250/F3A66B/000000?text=NEW%20IMAGE%207' 
            },
        };

        // Custom UI Alert/Message Box function
        function showMessage(title, message, isError = false) {
            const modal = document.getElementById('message-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const header = document.getElementById('modal-header');

            modalTitle.textContent = title;
            modalBody.innerHTML = message;
            
            if (isError) {
                header.className = 'p-4 bg-red-700 text-white font-bold rounded-t-xl';
            } else {
                header.className = 'p-4 bg-green-700 text-white font-bold rounded-t-xl';
            }
            modal.classList.remove('hidden');
        }

        // Function to return the correct image URL based on the selected emote
        function getEmoteImageUrl(emoteValue) {
            const emote = emotes[emoteValue];
            // This function now returns the 'url' property from the emotes object
            return emote ? emote.url : 'https://placehold.co/250x250/9400D3/ffffff?text=EMOTE%20ERROR';
        }
        
        // Function to update the displayed emote image
        function updateEmoteImage() {
            const emoteSelect = document.getElementById('emote-select');
            const emoteImage = document.getElementById('emote-image');
            emoteImage.src = getEmoteImageUrl(emoteSelect.value);
            
            // Fallback for image loading error (optional, but good practice)
            // If the image fails to load, it will show a generic error placeholder
            emoteImage.onerror = () => {
                emoteImage.src = 'https://placehold.co/250x250/9400D3/ffffff?text=IMAGE%20LOAD%20FAILED';
            };
            
            // Add a slight animation class for visual feedback
            emoteImage.classList.add('animate-pulse-once');
            setTimeout(() => {
                emoteImage.classList.remove('animate-pulse-once');
            }, 500);
        }


        document.addEventListener('DOMContentLoaded', async () => {
            // Initial image load
            updateEmoteImage();
            
            // Listener for dropdown change
            document.getElementById('emote-select').addEventListener('change', updateEmoteImage);

            try {
                // 1. Firebase Configuration
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

                if (Object.keys(firebaseConfig).length === 0) {
                    throw new Error("Firebase configuration not found. Cannot initialize Firestore.");
                }

                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                // 2. Authentication
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    const idElement = document.getElementById('session-user-id');
                    if (user) {
                        userId = user.uid;
                        idElement.textContent = userId; // Update UI with real UID
                        console.log('User signed in. UID:', userId);
                    } else {
                        // Fallback if anonymous sign-in fails
                        userId = crypto.randomUUID();
                        idElement.textContent = userId; // Update UI with UUID
                        console.log('User signed out or failed to sign in. Using UUID:', userId);
                    }
                });

            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
                showMessage("Setup Error", `Could not connect to the database. Firestore logging will be unavailable. Details: ${error.message}`, true);
            }


            // 3. Form Submission Handler
            const claimForm = document.getElementById('claim-form');
            claimForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const uid = document.getElementById('uid-input').value.trim();
                const level = parseInt(document.getElementById('level-input').value.trim(), 10);
                const emote = document.getElementById('emote-select').value;
                const claimButton = document.getElementById('claim-button');
                
                claimButton.disabled = true;
                claimButton.textContent = 'Processing...';

                // --- CRITICAL SAFETY WARNING LOGIC ---
                const safetyMessage = `
                    <p class="text-lg font-semibold mb-3 text-red-400">üö® ACCOUNT SAFETY WARNING üö®</p>
                    <p class="text-left mb-4">
                        This website is a **MOCKUP** for demonstration purposes only. It **CANNOT** interact with your Garena Free Fire account.
                    </p>
                    <p class="text-left mb-4">
                        **DO NOT** trust any external website that asks for your UID and promises free items. This is a common method used for phishing or scams.
                    </p>
                    <p class="text-left font-bold text-yellow-300">
                        Always claim rewards using **OFFICIAL REDEEM CODES** on the **Official Garena Redemption Site** only.
                    </p>
                    <hr class="my-4 border-gray-600">
                    <p class="text-left text-sm">
                        *Simulated Claim Data: UID: ${uid}, Level: ${level}, Emote: ${emotes[emote].name}*
                    </p>
                `;
                
                // Simulate an API call delay
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                try {
                    // Log the simulated attempt to Firestore (Private collection)
                    if (db && userId) {
                        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                        const claimsCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/emote_claims`);
                        
                        await addDoc(claimsCollectionRef, {
                            uid: uid,
                            level: level,
                            // Use the name for logging, not the URL
                            emote: emotes[emote].name, 
                            timestamp: new Date().toISOString(),
                            status: 'SIMULATED_SUCCESS_WARNING_ONLY'
                        });
                        console.log('Simulated claim attempt logged to Firestore.');
                    }
                    
                    showMessage("Claim Attempt Logged", safetyMessage, false);

                } catch (error) {
                    console.error("Error logging claim attempt to Firestore:", error);
                    showMessage("Simulated Claim Failed", safetyMessage + `<p class="mt-4 text-red-500">Database logging failed: ${error.message}</p>`, true);

                } finally {
                    claimButton.disabled = false;
                    claimButton.textContent = 'CLAIM EMOTE';
                }
            });

            // Close modal functionality
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('message-modal').classList.add('hidden');
            });
        });
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom Keyframes for a quick pulse effect */
        @keyframes pulse-once {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-pulse-once {
            animation: pulse-once 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-4 sm:p-8 flex items-center justify-center">

    <!-- Custom Modal/Message Box (Placed outside the main card for Z-index) -->
    <div id="message-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4 transition-opacity duration-300">
        <div class="bg-gray-800 rounded-xl max-w-sm w-full shadow-2xl overflow-hidden">
            <div id="modal-header" class="p-4 bg-green-700 text-white font-bold rounded-t-xl">
                <h3 id="modal-title" class="text-xl">Message</h3>
            </div>
            <div class="p-6 text-gray-100">
                <p id="modal-body" class="text-base text-center"></p>
                <button id="close-modal" class="mt-6 w-full py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition duration-200">
                    I Understand
                </button>
            </div>
        </div>
    </div>


    <!-- Main Content Card -->
    <div class="w-full max-w-lg bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-2xl border-2 border-red-600">
        
        <!-- Header -->
        <h1 class="text-3xl sm:text-4xl font-black text-center text-red-500 mb-2 tracking-wider uppercase">
            FREE EMOTE PORTAL
        </h1>
        <p class="text-sm text-center text-yellow-400 font-bold mb-6">
            <span class="bg-red-900 px-3 py-1 rounded-full">‚òÖ MOCKUP INTERFACE - READ SAFETY WARNING ‚òÖ</span>
        </p>

        <!-- Dynamic Emote Display Area -->
        <div class="flex flex-col items-center justify-center mb-6 p-4 bg-gray-700 rounded-xl border border-purple-500">
            <!-- Increased image size to w-64 h-64 -->
            <img id="emote-image" 
                 src="" 
                 alt="Selected Emote Placeholder" 
                 class="w-48 h-48 sm:w-64 sm:h-64 object-cover rounded-2xl border-4 border-yellow-400 shadow-xl transition-transform duration-300">
            <p class="mt-3 text-xl font-bold text-purple-400">LOL EMOTE</p>
        </div>


        <!-- Safety Disclaimer Box (Prominent) -->
        <div class="bg-red-950 p-4 rounded-xl mb-6 border-l-4 border-red-500 text-sm">
            <p class="font-bold text-red-300">‚ö†Ô∏è IMPORTANT SAFETY NOTICE</p>
            <p class="mt-1 text-gray-300">
                This is a demo design. Real in-game items (like emotes) can only be obtained through **official Garena events and redemption codes** on the Garena website. **Do not** enter your Free Fire login details on any unauthorized site.
            </p>
        </div>

        <!-- Claim Form -->
        <form id="claim-form" class="space-y-6">
            
            <!-- Emote Selection -->
            <div>
                <label for="emote-select" class="block text-sm font-medium text-gray-300 mb-2">
                    Select Your Desired LOL Emote
                </label>
                <select id="emote-select" name="emote" required
                        class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:ring focus:ring-red-500/50 text-white appearance-none pr-10 transition duration-200">
                    <option value="lol-emote-1">LOL Emote (Victory Dance)</option>
                    <option value="lol-emote-2">LOL Emote (Waving)</option>
                    <option value="lol-emote-3">LOL Emote (Heart)</option>
                    <option value="lol-emote-4">LOL Emote (Flex)</option>
                    <option value="lol-emote-5">LOL Emote (Running Man)</option>
                    <option value="lol-emote-6">LOL Emote (Image Option)</option> 
                    <option value="lol-emote-7">LOL Emote (Seventh Option)</option>
                </select>
                <!-- Custom arrow/icon for dropdown -->
                <div class="relative">
                    <span class="absolute right-3 top-[-36px] pointer-events-none text-gray-400">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </span>
                </div>
            </div>

            <!-- UID Input -->
            <div>
                <label for="uid-input" class="block text-sm font-medium text-gray-300 mb-2">
                    Player UID (Unique ID)
                </label>
                <input type="text" id="uid-input" name="uid" required 
                       placeholder="Enter your 10-digit Free Fire UID"
                       class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:ring focus:ring-red-500/50 text-white transition duration-200">
            </div>

            <!-- Level Input -->
            <div>
                <label for="level-input" class="block text-sm font-medium text-gray-300 mb-2">
                    Account Level
                </label>
                <input type="number" id="level-input" name="level" required min="1" max="100"
                       placeholder="Enter your current in-game level"
                       class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:ring focus:ring-red-500/50 text-white transition duration-200">
            </div>

            <!-- Claim Button -->
            <button type="submit" id="claim-button"
                    class="w-full py-3 mt-4 bg-red-600 hover:bg-red-700 text-white font-bold text-lg rounded-xl shadow-lg shadow-red-900/50 transition duration-300 transform hover:scale-[1.01] active:scale-[0.98]">
                CLAIM EMOTE
            </button>

        </form>
        
        <!-- User ID Display -->
        <p class="text-xs text-center text-gray-500 mt-6">
            Your Session ID: <span id="session-user-id" class="font-mono text-gray-400">Loading...</span>
        </p>

    </div>

</body>
</html>
